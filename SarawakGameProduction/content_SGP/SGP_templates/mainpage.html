<!DOCTYPE html>
{% extends 'mainheader_sgp.html' %}
{% block title %} Sarawak Game Platform - Game Hub {% endblock title %}

{% block content %}
<h2 style="text-align: center; margin-bottom: 20px;">Welcome to SGP Game Hub</h2>

<div style="display: flex; justify-content: space-between; max-width: 1200px; margin: auto;">
    <!-- Main Content: Game List -->
    <div style="width: 70%; padding: 20px;">
        <h3>Available Games</h3>
        <div id="game_list">
            <!-- Games will be dynamically loaded here -->
        </div>
    </div>

    <!-- Side Content: Partners List -->
    <div style="width: 25%; padding: 20px; border-left: 1px solid #ddd;">
        <h3>Our Partners</h3>
        <ul id="partners_list">
            <li>Loading partners...</li>
        </ul>
    </div>
</div>

{% endblock content %}

{% block script %}
<script>
    // Load games dynamically (Assume games are fetched from an API)
    function loadGames() {
        let gameListDiv = document.getElementById("game_list");
        gameListDiv.innerHTML = "<p>Loading games...</p>";

        fetch("/api/games/") // Backend must return a list of games
            .then(response => response.json())
            .then(data => {
                gameListDiv.innerHTML = "";
                data.games.forEach(game => {
                    let gameDiv = document.createElement("div");
                    gameDiv.innerHTML = `
                        <div style="border: 1px solid #ccc; padding: 10px; margin: 10px; border-radius: 5px;">
                            <h4>${game.name}</h4>
                            <p>${game.description}</p>
                            <button onclick="playGame('${game.id}')">Play Now</button>
                        </div>
                    `;
                    gameListDiv.appendChild(gameDiv);
                });
            })
            .catch(() => {
                gameListDiv.innerHTML = "<p>Error loading games</p>";
            });
    }

    function playGame(gameId) {
        window.location.href = "/game/play/" + gameId;
    }

    // Load XML partner data dynamically
    function loadPartners() {
        let partnersList = document.getElementById("partners_list");
        partnersList.innerHTML = "<li>Loading partners...</li>";

        fetch("{% url 'partners_view' %}")  // Backend should return the XML data as JSON
            .then(response => response.json())
            .then(data => {
                partnersList.innerHTML = "";
                data.partners.forEach(partner => {
                    let li = document.createElement("li");
                    li.innerHTML = `<strong>${partner.name}</strong> (${partner.email})`;
                    partnersList.appendChild(li);
                });
            })
            .catch(() => {
                partnersList.innerHTML = "<li>Error loading partners</li>";
            });
    }

    // Load data when page loads
    document.addEventListener("DOMContentLoaded", () => {
        loadGames();
        loadPartners();
    });
</script>
{% endblock script %}
